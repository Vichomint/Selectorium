{% extends "layout_postulante.html" %}
{% load static %}

{% block main_content %}
<div class="max-w-5xl mx-auto space-y-8">
  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-bold text-gray-900">Mis postulaciones</h1>
      <p class="mt-1 text-sm text-gray-600">
        Revisa el estado actual de cada postulación que enviaste.
      </p>
    </div>
    <a
      href="{% url 'listar_vacantes' %}"
      class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-primary-600 text-white text-sm font-semibold shadow-sm hover:bg-primary-700 transition"
    >
      <i class="fas fa-search"></i>
      Buscar nuevas vacantes
    </a>
  </div>

  {% if postulaciones %}
    <div class="grid gap-6">
      {% for postulacion in postulaciones %}
        <article class="bg-white border border-gray-100 shadow-sm rounded-2xl p-6 transition hover:shadow-md">
          <div class="flex flex-col gap-3 md:flex-row md:items-start md:justify-between">
            <div class="space-y-2">
              <h2 class="text-xl font-semibold text-gray-900">
                {{ postulacion.vacante.titulo }}
              </h2>
              <div class="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                <span class="inline-flex items-center gap-2">
                  <i class="fas fa-calendar-alt text-primary-500"></i>
                  Postulaste el {{ postulacion.fecha_postulacion|date:"d/m/Y" }}
                </span>
                {% if postulacion.vacante.ubicacion %}
                  <span class="inline-flex items-center gap-2">
                    <i class="fas fa-map-marker-alt text-primary-500"></i>
                    {{ postulacion.vacante.ubicacion }}
                  </span>
                {% endif %}
              </div>
            </div>
            {% with estado=postulacion.estado %}
              <span
                class="inline-flex items-center justify-center px-3 py-1 rounded-full text-xs font-semibold uppercase
                {% if estado == 'aceptado' %}bg-emerald-100 text-emerald-700
                {% elif estado == 'rechazado' %}bg-rose-100 text-rose-700
                {% elif estado == 'visto' %}bg-amber-100 text-amber-700
                {% else %}bg-blue-100 text-blue-700{% endif %}"
              >
                {{ postulacion.get_estado_display }}
              </span>
            {% endwith %}
          </div>

          <p class="mt-4 text-sm text-gray-600">
            {{ postulacion.vacante.descripcion|truncatechars:250 }}
          </p>

          <div class="mt-6 flex flex-wrap gap-3">
            <a
              href="{% url 'detalle_vacante' postulacion.vacante.id %}"
              class="inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition"
            >
              <i class="fas fa-eye"></i>
              Ver vacante
            </a>
            <a
              href="{% url 'listar_vacantes' %}"
              class="inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg border border-primary-200 text-primary-600 hover:bg-primary-50 transition"
            >
              <i class="fas fa-briefcase"></i>
              Explorar más oportunidades
            </a>
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <div class="bg-white border border-dashed border-primary-200 rounded-2xl p-12 text-center">
      <div class="flex flex-col items-center gap-3">
        <div class="h-12 w-12 flex items-center justify-center rounded-full bg-primary-100 text-primary-600">
          <i class="fas fa-clipboard-list text-xl"></i>
        </div>
        <h2 class="text-xl font-semibold text-gray-900">Aún no has postulado</h2>
        <p class="text-sm text-gray-600 max-w-md">
          Explora las vacantes disponibles para encontrar aquella que se ajuste a tu perfil profesional.
        </p>
        <a
          href="{% url 'listar_vacantes' %}"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-primary-600 text-white text-sm font-semibold shadow-sm hover:bg-primary-700 transition"
        >
          <i class="fas fa-search"></i>
          Ver vacantes disponibles
        </a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
